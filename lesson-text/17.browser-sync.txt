Browser Sync

Плагин browser-sync хоть и не является обработчиков в привычном нам
понимании, но выполняет одну из самых полезных функций при разработке
Frontend — автоматическое обновление окна браузера при выполнении функций.
Вы сами можете выбирать на какие действия будет происходить перезагрузка.

Именно благодаря browser-sync возможно развернуть условное рабочее
окружение, где вам не нужно беспокоиться о компиляции файлов и обновлении
браузера. Всё будет происходить «на лету».

Для использования browser-sync достаточно установить одноимённый пакет.
Он подходит не только для Gulp, а его можно использовать как
самостоятельный пакет в любых других проектах, поэтому какой-то
специальной версии под Gulp не существует.

npm install browser-sync --save-dev

Для начала, с помощью плагина, создадим локальный сервер.
Для этого необходимо подключить плагин и инициализировать его с
параметром server:

См. ./../lesson-files/gulpfile [browser-sync].js

Теперь, при запуске задачи server будет запущен специальный
локальный сервер, корнем которого станет директория build/ нашего проекта.
После запуска вы можете перейти по адресу, указанному в поле Local или
External.

См. ./../images/browser-sync.png

У пакета browser-sync есть ещё один полезный метод .stream(), который
позволяет автоматически обратиться к локальному серверу и перезагрузить
его. Эта операция, в большинстве случаев, добавляется в самый конец
функции внутри знакомого нам pipe(). Например, дополним пример с
обработкой SASS и Pug, добавив в конец каждой функции строку
.pipe(browserSync.stream()):

См. ./../lesson-files/gulpfile [browser-sync-stream].js

Теперь, в качестве финального аккорда, необходимо добавить вотчеры,
чтобы выполнять компиляции при изменении файлов. Но как это лучше всего
сделать? Хорошим вариантом является добавление функций watch()
внутри задачи создания сервера, то есть в функцию browserSyncJob().
В ней вначале будет запущен сервер, а затем вотчеры, которые будут
следить за всеми изменениями файлов.

См. ./../lesson-files/gulpfile [browser-sync-watch].js
См. ./../images/browser-sync-watch.png